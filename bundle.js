!function(){"use strict";const e={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"},t=document.querySelector("#card-template").content.querySelector(".card"),i=document.querySelector(".popup_type_add-card"),s=document.querySelector(".profile").querySelector(".profile__edit-button"),n=document.querySelector(".profile").querySelector(".profile__add-button"),o=document.querySelector(".popup_type_edit-profile"),r=document.querySelector(".popup__input_type_name"),l=document.querySelector(".popup__input_type_description");function a(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class u{constructor(e,t,i){let{handleCardClick:s}=i;a(this,"_handleLikeButton",(e=>{e.currentTarget.classList.toggle("photos__like-button_active")})),a(this,"_handleDeleteCard",(()=>{this._element.remove(),this._element=null})),this._template=t,this._data=e,this._element=null,this._handleCardClick=s}_getTemplate(){return this._template.cloneNode(!0)}_setEventListeners(){this._cardLikeButton.addEventListener("click",this._handleLikeButton),this._cardDeleteButton.addEventListener("click",this._handleDeleteCard),this._cardImage.addEventListener("click",this._handleCardClick)}generateCard(){this._element=this._getTemplate(),this._cardLikeButton=this._element.querySelector(".button_type_like"),this._cardDeleteButton=this._element.querySelector(".button_type_delete"),this._cardImage=this._element.querySelector(".photos__card-img");const e=this._element.querySelector(".photos__title");return this._cardImage.src=this._data.link,this._cardImage.alt=this._data.title,e.textContent=this._data.title,this._setEventListeners(),this._element}}class p{constructor(e,t){this._settings=e,this._formElement=t}_showInputError(e){const t=this._formElement.querySelector("#".concat(e.id,"-error"));e.classList.add(this._settings.inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._settings.errorClass)}_hideInputError(e){const t=this._formElement.querySelector("#".concat(e.id,"-error"));e.classList.remove(this._settings.inputErrorClass),e.classList.remove(this._settings.errorClass),t.textContent=""}_checkInputValidity(e){e.validity.valid?this._hideInputError(e,this._settings):this._showInputError(e,this._settings)}_hasInvalidInput(e){return e.some((e=>!e.validity.valid))}_disableSubmitButton(){this._buttonElement.setAttribute("disabled",!0),this._buttonElement.classList.add(this._settings.inactiveButtonClass)}enableSubmitButton(){this._buttonElement.removeAttribute("disabled"),this._buttonElement.classList.remove(this._settings.inactiveButtonClass)}_toggleButtonState(){this._hasInvalidInput(this._inputList)?this._disableSubmitButton():this.enableSubmitButton()}resetValidation(){this._inputList.forEach((e=>{this._hideInputError(e)})),this._toggleButtonState()}_setEventListeners(){this._inputList=Array.from(this._formElement.querySelectorAll(this._settings.inputSelector)),this._buttonElement=this._formElement.querySelector(this._settings.submitButtonSelector),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}function c(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class _{constructor(e){c(this,"_handleEscClose",(e=>{"Escape"===e.key&&this.close()})),c(this,"_checkOverlayContainer",(e=>{e.target.closest(".popup__container")||e.currentTarget.closest(".popup").classList.remove("popup_opened")})),this._popup=document.querySelector(e),this.close=this.close.bind(this)}open(){this._popup.classList.add("popup_opened"),this._setEventListeners()}close(){this._popup.classList.remove("popup_opened"),this._removeEventListeners()}_removeEventListeners(){this._closeButton.removeEventListener("click",this.close),this._popup.removeEventListener("click",this._checkOverlayContainer),document.removeEventListener("keydown",this._handleEscClose)}_setEventListeners(){this._closeButton=this._popup.querySelector(".popup__close-button"),this._closeButton.addEventListener("click",this.close),this._popup.addEventListener("click",this._checkOverlayContainer),this._popup.classList.contains("popup_opened")&&document.addEventListener("keydown",this._handleEscClose)}}function h(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function d(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class m extends _{constructor(e,t){let{handleSubmit:i}=t;super(e),d(this,"_getInputValues",(()=>(this._inputList=this._popup.querySelectorAll(".popup__input"),this._formValues={},this._inputList.forEach((e=>{this._formValues[e.name]=e.value})),this._formValues))),d(this,"_handleFormSubmit",(e=>{e.preventDefault(),this._handleSubmit(this._getInputValues())})),this._handleSubmit=i,this._formElement=this._popup.querySelector(".popup__form")}open(){super.open(),this._formElement.addEventListener("submit",this._handleFormSubmit)}close(){super.close(),this._formElement.reset(),this._formElement.removeEventListener("submit",this._handleFormSubmit)}}const f=new p(e,o);f.enableValidation();const b=new p(e,i);b.enableValidation();const v=new class extends _{constructor(e){super(e),h(this,"open",(e=>{let{link:t,caption:i}=e;const s=this._popup.querySelector(".popup__image"),n=this._popup.querySelector(".popup__image-caption");s.src=t,s.alt=i,n.textContent=i,super.open()})),h(this,"close",(()=>{super.close()}))}}(".popup_type_preview"),y=e=>{const i=new u(e,t,{handleCardClick:e=>{v.open({link:e.target.src,caption:e.target.alt})}});E.addItem(i.generateCard())},E=new class{constructor(e,t){let{items:i,renderer:s}=e;this._items=i,this._renderer=s,this._container=document.querySelector(t)}renderer(){this._items.forEach((e=>this._renderer(e)))}addItem(e){this._container.prepend(e)}}({items:[{title:"McWay Falls",link:"https://images.unsplash.com/photo-1432889490240-84df33d47091?ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&ixlib=rb-1.2.1&auto=format&fit=crop&w=1489&q=80"},{title:"Arches National Park",link:"https://images.unsplash.com/photo-1469854523086-cc02fe5d8800?ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&ixlib=rb-1.2.1&auto=format&fit=crop&w=1608&q=80"},{title:"Inian Islands",link:"https://images.unsplash.com/photo-1597800235425-ef23b8bcdffd?ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&ixlib=rb-1.2.1&auto=format&fit=crop&w=968&q=80"},{title:"Antelope Canyon",link:"https://images.unsplash.com/photo-1505521377774-103a8cc2f735?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=934&q=80"},{title:"Grand Teton National Park",link:"https://images.unsplash.com/photo-1533083653349-e2882c0d1208?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1500&q=80"},{title:"Boulder, Colorado",link:"https://images.unsplash.com/photo-1609645918655-65c52395f976?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1000&q=80"}],renderer:y},".photos__card-grid");E.renderer();const g=new m(".popup_type_add-card",{handleSubmit:e=>{y(e),g.close()}}),S=new class{constructor(e){let{userName:t,userJob:i}=e;var s,n;n=e=>{let{formData:t}=e;this._profileNameElement.textContent=t.name,this._profileTitleElement.textContent=t.description},(s="setUserInfo")in this?Object.defineProperty(this,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):this[s]=n,this._profileNameElement=document.querySelector(t),this._profileTitleElement=document.querySelector(i)}getUserInfo(){return this._userInfo={name:this._profileNameElement.textContent,description:this._profileTitleElement.textContent},this._userInfo}}({userName:".profile__name",userJob:".profile__description"}),x=new m(".popup_type_edit-profile",{handleSubmit:e=>{x.close(),S.setUserInfo({formData:e})}});s.addEventListener("click",(()=>{f.resetValidation();const{name:e,description:t}=S.getUserInfo();r.value=e,l.value=t,x.open()})),n.addEventListener("click",(()=>{b.resetValidation(),g.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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VlIsS0FDdEJzRSxFQUF5QmpDLGtCQUV6QixNQUFNLEtBQUUyQixFQUFGLFlBQVFnQyxHQUFnQk4sRUFBU08sY0FDdkN0SCxFQUFpQnNGLE1BQVFELEVBQ3pCcEYsRUFBd0JxRixNQUFRK0IsRUFFaENHLEVBQWtCOUMsTUFBbEIsSUFLRjVFLEVBQVd1QixpQkFBaUIsU0EvQlAsS0FDbkJ1RSxFQUFxQmxDLGtCQUNyQm9ELEVBQWVwQyxNQUFmLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zcHJpbnQtOC15dXJ5LWNob2UvLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3NwcmludC04LXl1cnktY2hvZS8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vc3ByaW50LTgteXVyeS1jaG9lLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9zcHJpbnQtOC15dXJ5LWNob2UvLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9zcHJpbnQtOC15dXJ5LWNob2UvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3NwcmludC04LXl1cnktY2hvZS8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9zcHJpbnQtOC15dXJ5LWNob2UvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly9zcHJpbnQtOC15dXJ5LWNob2UvLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3NwcmludC04LXl1cnktY2hvZS8uL3NyYy91dGlscy9pbml0aWFsLWNhcmRzLmpzIiwid2VicGFjazovL3NwcmludC04LXl1cnktY2hvZS8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjb25zdCB2YWxpZGF0aW9uQ29uZmlnID0ge1xuICBmb3JtU2VsZWN0b3I6ICcucG9wdXBfX2Zvcm0nLFxuICBpbnB1dFNlbGVjdG9yOiAnLnBvcHVwX19pbnB1dCcsIFxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogJy5wb3B1cF9fYnV0dG9uJywgXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6ICdwb3B1cF9fYnV0dG9uX2Rpc2FibGVkJyxcbiAgaW5wdXRFcnJvckNsYXNzOiAncG9wdXBfX2lucHV0X3R5cGVfZXJyb3InLFxuICBlcnJvckNsYXNzOiAncG9wdXBfX2Vycm9yX3Zpc2libGUnXG59O1xuXG5leHBvcnQgY29uc3QgY2FyZExpc3RTZWN0aW9uID0gJy5waG90b3NfX2NhcmQtZ3JpZCc7XG5cbmV4cG9ydCBjb25zdCBwb3B1cFR5cGUgPSB7XG4gIGVkaXRQcm9maWxlU2VsZWN0b3I6ICcucG9wdXBfdHlwZV9lZGl0LXByb2ZpbGUnLFxuICBhZGRDYXJkU2VsZWN0b3I6ICcucG9wdXBfdHlwZV9hZGQtY2FyZCcsXG4gIHByZXZpZXdTZWxlY3RvcjogJy5wb3B1cF90eXBlX3ByZXZpZXcnXG59XG5cbmV4cG9ydCBjb25zdCBwcm9maWxlQ29uZmlnID0ge1xuICBuYW1lU2VsZWN0b3I6ICcucHJvZmlsZV9fbmFtZScsXG4gIGRlc2NyaXB0aW9uU2VsZWN0b3I6ICcucHJvZmlsZV9fZGVzY3JpcHRpb24nLFxufVxuXG5leHBvcnQgY29uc3QgY2FyZFRlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2NhcmQtdGVtcGxhdGUnKS5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkJyk7XG5cbmV4cG9ydCBjb25zdCBhZGRDYXJkTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfdHlwZV9hZGQtY2FyZCcpO1xuXG5leHBvcnQgY29uc3QgcHJvZmlsZUVkaXRCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZScpLnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19lZGl0LWJ1dHRvbicpO1xuXG5leHBvcnQgY29uc3QgYWRkQ2FyZEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlJykucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2FkZC1idXR0b24nKTtcblxuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfdHlwZV9lZGl0LXByb2ZpbGUnKTtcblxuZXhwb3J0IGNvbnN0IHByb2ZpbGVOYW1lSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2lucHV0X3R5cGVfbmFtZScpO1xuXG5leHBvcnQgY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2lucHV0X3R5cGVfZGVzY3JpcHRpb24nKTsiLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJkIHtcbiAgY29uc3RydWN0b3IoZGF0YSwgdGVtcGxhdGUsIHsgaGFuZGxlQ2FyZENsaWNrIH0pIHtcbiAgICB0aGlzLl90ZW1wbGF0ZSA9IHRlbXBsYXRlOyBcbiAgICB0aGlzLl9kYXRhID0gZGF0YTtcbiAgICB0aGlzLl9lbGVtZW50ID0gbnVsbDtcbiAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sgPSBoYW5kbGVDYXJkQ2xpY2s7XG4gIH1cbiAgXG4gIF9nZXRUZW1wbGF0ZSgpIHtcbiAgICByZXR1cm4gdGhpcy5fdGVtcGxhdGVcbiAgICAuY2xvbmVOb2RlKHRydWUpO1xuICB9XG4gIFxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fY2FyZExpa2VCdXR0b25cbiAgICAuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLl9oYW5kbGVMaWtlQnV0dG9uKTtcblxuICAgIHRoaXMuX2NhcmREZWxldGVCdXR0b25cbiAgICAuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLl9oYW5kbGVEZWxldGVDYXJkKTtcbiAgICBcbiAgICB0aGlzLl9jYXJkSW1hZ2VcbiAgICAuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLl9oYW5kbGVDYXJkQ2xpY2spO1xuICB9XG4gIFxuICBfaGFuZGxlTGlrZUJ1dHRvbiA9IChldnQpID0+IHtcbiAgICBldnQuY3VycmVudFRhcmdldC5jbGFzc0xpc3QudG9nZ2xlKCdwaG90b3NfX2xpa2UtYnV0dG9uX2FjdGl2ZScpO1xuICB9XG4gIFxuICBfaGFuZGxlRGVsZXRlQ2FyZCA9ICgpID0+IHtcbiAgICB0aGlzLl9lbGVtZW50LnJlbW92ZSgpO1xuICAgIHRoaXMuX2VsZW1lbnQgPSBudWxsO1xuICB9XG5cbiAgZ2VuZXJhdGVDYXJkKCkge1xuICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xuXG4gICAgdGhpcy5fY2FyZExpa2VCdXR0b24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5idXR0b25fdHlwZV9saWtlJyk7XG4gICAgdGhpcy5fY2FyZERlbGV0ZUJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmJ1dHRvbl90eXBlX2RlbGV0ZScpO1xuICAgIHRoaXMuX2NhcmRJbWFnZSA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLnBob3Rvc19fY2FyZC1pbWcnKTtcbiAgICBjb25zdCBjYXJkVGl0bGUgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5waG90b3NfX3RpdGxlJyk7XG5cbiAgICB0aGlzLl9jYXJkSW1hZ2Uuc3JjID0gdGhpcy5fZGF0YS5saW5rO1xuICAgIHRoaXMuX2NhcmRJbWFnZS5hbHQgPSB0aGlzLl9kYXRhLnRpdGxlO1xuICAgIGNhcmRUaXRsZS50ZXh0Q29udGVudCA9IHRoaXMuX2RhdGEudGl0bGU7XG4gICAgXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xuICB9XG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XG4gIGNvbnN0cnVjdG9yKHNldHRpbmdzLCBmb3JtRWxlbWVudCkge1xuICAgIHRoaXMuX3NldHRpbmdzID0gc2V0dGluZ3M7XG4gICAgdGhpcy5fZm9ybUVsZW1lbnQgPSBmb3JtRWxlbWVudDtcbiAgfSBcbiAgXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2U7XG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fc2V0dGluZ3MuZXJyb3JDbGFzcyk7XG4gIH1cbiAgXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzKTtcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9zZXR0aW5ncy5lcnJvckNsYXNzKTtcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSAnJztcbiAgfVxuICBcbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpIHtcbiAgICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50LCB0aGlzLl9zZXR0aW5ncyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgdGhpcy5fc2V0dGluZ3MpO1xuICAgIH1cbiAgfVxuICBcbiAgX2hhc0ludmFsaWRJbnB1dChpbnB1dExpc3QpIHtcbiAgICByZXR1cm4gaW5wdXRMaXN0LnNvbWUoaW5wdXRFbGVtZW50ID0+ICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpO1xuICB9XG4gIFxuICBfZGlzYWJsZVN1Ym1pdEJ1dHRvbigpIHtcbiAgICB0aGlzLl9idXR0b25FbGVtZW50LnNldEF0dHJpYnV0ZSgnZGlzYWJsZWQnLCB0cnVlKTtcbiAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gIH1cbiAgXG4gIGVuYWJsZVN1Ym1pdEJ1dHRvbigpIHtcbiAgICB0aGlzLl9idXR0b25FbGVtZW50LnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnKTtcbiAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gIH1cblxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCh0aGlzLl9pbnB1dExpc3QpKSB7XG4gICAgICB0aGlzLl9kaXNhYmxlU3VibWl0QnV0dG9uKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuZW5hYmxlU3VibWl0QnV0dG9uKCk7XG4gICAgfVxuICB9XG4gIFxuICByZXNldFZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goaW5wdXQgPT4ge1xuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXQpO1xuICAgIH0pXG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9pbnB1dExpc3QgPSBBcnJheS5mcm9tKHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5fc2V0dGluZ3MuaW5wdXRTZWxlY3RvcikpO1xuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuX3NldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcbiAgICBcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaChpbnB1dEVsZW1lbnQgPT4ge1xuICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKCkgPT4ge1xuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KTtcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG4gIFxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIChldnQpID0+IHtcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH0pO1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICB0aGlzLl9wb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5jbG9zZSA9IHRoaXMuY2xvc2UuYmluZCh0aGlzKTtcbiAgfVxuXG4gIG9wZW4oKSB7XG4gICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LmFkZCgncG9wdXBfb3BlbmVkJyk7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxuXG4gIGNsb3NlKCkge1xuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5yZW1vdmUoJ3BvcHVwX29wZW5lZCcpO1xuICAgIHRoaXMuX3JlbW92ZUV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cbiAgXG4gIF9oYW5kbGVFc2NDbG9zZSA9IChldnQpID0+IHtcbiAgICBpZiAoZXZ0LmtleSA9PT0gJ0VzY2FwZScpIHRoaXMuY2xvc2UoKTtcbiAgfVxuICBcbiAgX2NoZWNrT3ZlcmxheUNvbnRhaW5lciA9IChldnQpID0+IHtcbiAgICBpZiAoIWV2dC50YXJnZXQuY2xvc2VzdCgnLnBvcHVwX19jb250YWluZXInKSkge1xuICAgICAgZXZ0LmN1cnJlbnRUYXJnZXQuY2xvc2VzdCgnLnBvcHVwJykuY2xhc3NMaXN0LnJlbW92ZSgncG9wdXBfb3BlbmVkJyk7XG4gICAgfTtcbiAgfVxuXG4gIF9yZW1vdmVFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9jbG9zZUJ1dHRvbi5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuY2xvc2UpO1xuICAgIFxuICAgIHRoaXMuX3BvcHVwLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5fY2hlY2tPdmVybGF5Q29udGFpbmVyKTtcbiAgICBcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICB9XG4gIFxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fY2xvc2VCdXR0b24gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2Nsb3NlLWJ1dHRvbicpOyBcbiAgICB0aGlzLl9jbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuY2xvc2UpO1xuICAgIFxuICAgIHRoaXMuX3BvcHVwLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5fY2hlY2tPdmVybGF5Q29udGFpbmVyKTtcblxuICAgIGlmICh0aGlzLl9wb3B1cC5jbGFzc0xpc3QuY29udGFpbnMoJ3BvcHVwX29wZW5lZCcpKSB7XG4gICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICAgIH07XG4gIH1cbn0iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXBcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybXMgZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIHsgaGFuZGxlU3VibWl0IH0pIHtcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLl9oYW5kbGVTdWJtaXQgPSBoYW5kbGVTdWJtaXQ7XG4gICAgdGhpcy5fZm9ybUVsZW1lbnQgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2Zvcm0nKTtcbiAgfVxuXG4gIG9wZW4oKSB7XG4gICAgc3VwZXIub3BlbigpO1xuICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQpO1xuICB9XG4gIFxuICBjbG9zZSgpIHtcbiAgICBzdXBlci5jbG9zZSgpO1xuICAgIHRoaXMuX2Zvcm1FbGVtZW50LnJlc2V0KCk7XG4gICAgdGhpcy5fZm9ybUVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignc3VibWl0JywgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCk7XG4gIH1cbiAgXG4gIF9nZXRJbnB1dFZhbHVlcyA9ICgpID0+IHtcbiAgICB0aGlzLl9pbnB1dExpc3QgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yQWxsKCcucG9wdXBfX2lucHV0Jyk7XG4gICAgdGhpcy5fZm9ybVZhbHVlcyA9IHt9O1xuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKGlucHV0ID0+IHtcbiAgICAgIHRoaXMuX2Zvcm1WYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcbiAgICB9KTtcbiAgICByZXR1cm4gdGhpcy5fZm9ybVZhbHVlcztcbiAgfVxuICBcbiAgX2hhbmRsZUZvcm1TdWJtaXQgPSAoZXZ0KSA9PiB7XG4gICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgdGhpcy5faGFuZGxlU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xuICB9XG59IiwiaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcbmltcG9ydCB7XG4gIHZhbGlkYXRpb25Db25maWcsXG4gIGNhcmRMaXN0U2VjdGlvbixcbiAgcG9wdXBUeXBlLFxuICBwcm9maWxlQ29uZmlnLFxuICBjYXJkVGVtcGxhdGUsXG4gIGFkZENhcmRNb2RhbCxcbiAgcHJvZmlsZUVkaXRCdG4sXG4gIGFkZENhcmRCdG4sXG4gIHByb2ZpbGVFZGl0TW9kYWwsXG4gIHByb2ZpbGVOYW1lSW5wdXQsIFxuICBwcm9maWxlRGVzY3JpcHRpb25JbnB1dCxcbn0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50c1wiO1xuaW1wb3J0IHsgaW5pdGlhbENhcmRzIH0gZnJvbSBcIi4uL3V0aWxzL2luaXRpYWwtY2FyZHNcIjtcbmltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmRcIjtcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3JcIjtcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb25cIjtcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZVwiO1xuaW1wb3J0IFBvcHVwV2l0aEZvcm1zIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm1cIjtcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mb1wiO1xuXG5jb25zdCBlZGl0UHJvZmlsZUZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcih2YWxpZGF0aW9uQ29uZmlnLCBwcm9maWxlRWRpdE1vZGFsKTtcblxuZWRpdFByb2ZpbGVGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcblxuY29uc3QgYWRkQ2FyZEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcih2YWxpZGF0aW9uQ29uZmlnLCBhZGRDYXJkTW9kYWwpO1xuXG5hZGRDYXJkRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5cbmNvbnN0IHByZXZpZXdDYXJkUG9wdXAgPSBuZXcgUG9wdXBXaXRoSW1hZ2UocG9wdXBUeXBlLnByZXZpZXdTZWxlY3Rvcik7XG5cbmNvbnN0IHJlbmRlckNhcmQgPSAoaXRlbSkgPT4ge1xuICBjb25zdCBjYXJkID0gbmV3IENhcmQoXG4gICAgaXRlbSxcbiAgICBjYXJkVGVtcGxhdGUsXG4gICAge1xuICAgICAgaGFuZGxlQ2FyZENsaWNrOiAoaXRlbSkgPT4ge1xuICAgICAgICBwcmV2aWV3Q2FyZFBvcHVwLm9wZW4oXG4gICAgICAgICAge1xuICAgICAgICAgICAgbGluazogaXRlbS50YXJnZXQuc3JjLFxuICAgICAgICAgICAgY2FwdGlvbjogaXRlbS50YXJnZXQuYWx0XG4gICAgICAgICAgfVxuICAgICAgICApXG4gICAgICB9XG4gICAgfSk7XG4gIGNhcmRMaXN0LmFkZEl0ZW0oY2FyZC5nZW5lcmF0ZUNhcmQoKSk7XG59O1xuXG5jb25zdCBjYXJkTGlzdCA9IG5ldyBTZWN0aW9uKFxuICB7XG4gICAgaXRlbXM6IGluaXRpYWxDYXJkcyxcbiAgICByZW5kZXJlcjogcmVuZGVyQ2FyZFxuICB9LCBjYXJkTGlzdFNlY3Rpb24pO1xuXG5jYXJkTGlzdC5yZW5kZXJlcigpO1xuXG5jb25zdCBzdWJtaXRDYXJkRm9ybSA9IG5ldyBQb3B1cFdpdGhGb3Jtcyhwb3B1cFR5cGUuYWRkQ2FyZFNlbGVjdG9yLCB7XG4gIGhhbmRsZVN1Ym1pdDogKGl0ZW0pID0+IHtcbiAgICByZW5kZXJDYXJkKGl0ZW0pO1xuICAgIHN1Ym1pdENhcmRGb3JtLmNsb3NlKCk7XG4gIH1cbn0pO1xuXG5jb25zdCBvcGVuQ2FyZEZvcm0gPSAoKSA9PiB7XG4gIGFkZENhcmRGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xuICBzdWJtaXRDYXJkRm9ybS5vcGVuKCk7XG59XG5cbmNvbnN0IHVzZXJEYXRhID0gbmV3IFVzZXJJbmZvKFxuICB7XG4gICAgdXNlck5hbWU6IHByb2ZpbGVDb25maWcubmFtZVNlbGVjdG9yLCBcbiAgICB1c2VySm9iOiBwcm9maWxlQ29uZmlnLmRlc2NyaXB0aW9uU2VsZWN0b3JcbiAgfVxuKTtcblxuY29uc3Qgc3VibWl0UHJvZmlsZUZvcm0gPSBuZXcgUG9wdXBXaXRoRm9ybXMocG9wdXBUeXBlLmVkaXRQcm9maWxlU2VsZWN0b3IsIHtcbiAgaGFuZGxlU3VibWl0OiAoZm9ybURhdGEpID0+IHtcbiAgICBzdWJtaXRQcm9maWxlRm9ybS5jbG9zZSgpO1xuICAgIHVzZXJEYXRhLnNldFVzZXJJbmZvKHtmb3JtRGF0YX0pO1xuICB9XG59KTtcblxuY29uc3Qgb3BlblByb2ZpbGVGb3JtID0gKCkgPT4ge1xuICBlZGl0UHJvZmlsZUZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XG4gIFxuICBjb25zdCB7IG5hbWUsIGRlc2NyaXB0aW9uIH0gPSB1c2VyRGF0YS5nZXRVc2VySW5mbygpO1xuICBwcm9maWxlTmFtZUlucHV0LnZhbHVlID0gbmFtZTsgXG4gIHByb2ZpbGVEZXNjcmlwdGlvbklucHV0LnZhbHVlID0gZGVzY3JpcHRpb247XG5cbiAgc3VibWl0UHJvZmlsZUZvcm0ub3BlbigpO1xufTtcblxucHJvZmlsZUVkaXRCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvcGVuUHJvZmlsZUZvcm0pO1xuXG5hZGRDYXJkQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb3BlbkNhcmRGb3JtKTsiLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXBcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgfVxuXG4gIG9wZW4gPSAoeyBsaW5rLCBjYXB0aW9uIH0pID0+IHtcbiAgICBjb25zdCBpbWFnZUVsZW1lbnQgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2ltYWdlJyk7XG4gICAgY29uc3QgY2FwdGlvbkVsZW1lbnQgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2ltYWdlLWNhcHRpb24nKTtcbiAgICBpbWFnZUVsZW1lbnQuc3JjID0gbGluaztcbiAgICBpbWFnZUVsZW1lbnQuYWx0ID0gY2FwdGlvbjtcbiAgICBjYXB0aW9uRWxlbWVudC50ZXh0Q29udGVudCA9IGNhcHRpb247XG4gICAgc3VwZXIub3BlbigpO1xuICB9XG5cbiAgY2xvc2UgPSAoKSA9PiB7XG4gICAgLy8gYXJyb3cgc3ludGF4IG5lY2Vzc2FyeSBmb3IgaW5oZXJpdGFuY2VcbiAgICBzdXBlci5jbG9zZSgpO1xuICB9XG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XG4gICAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xuICAgICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xuICB9XG4gIHJlbmRlcmVyKCkge1xuICAgIHRoaXMuX2l0ZW1zLmZvckVhY2goaXRlbSA9PiB0aGlzLl9yZW5kZXJlcihpdGVtKSk7XG4gIH1cblxuICBhZGRJdGVtKGVsZW1lbnQpIHtcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcbiAgfVxufSIsImV4cG9ydCBjb25zdCBpbml0aWFsQ2FyZHMgPSBbXG4gIHtcbiAgICB0aXRsZTogJ01jV2F5IEZhbGxzJyxcbiAgICBsaW5rOiAnaHR0cHM6Ly9pbWFnZXMudW5zcGxhc2guY29tL3Bob3RvLTE0MzI4ODk0OTAyNDAtODRkZjMzZDQ3MDkxP2l4aWQ9TW53eE1qQTNmREI4TUh4d2FHOTBieTF3WVdkbGZIeDhmR1Z1ZkRCOGZIeDgmaXhsaWI9cmItMS4yLjEmYXV0bz1mb3JtYXQmZml0PWNyb3Amdz0xNDg5JnE9ODAnXG4gIH0sXG4gIHtcbiAgICB0aXRsZTogJ0FyY2hlcyBOYXRpb25hbCBQYXJrJyxcbiAgICBsaW5rOiAnaHR0cHM6Ly9pbWFnZXMudW5zcGxhc2guY29tL3Bob3RvLTE0Njk4NTQ1MjMwODYtY2MwMmZlNWQ4ODAwP2l4aWQ9TW53eE1qQTNmREI4TUh4d2FHOTBieTF3WVdkbGZIeDhmR1Z1ZkRCOGZIeDgmaXhsaWI9cmItMS4yLjEmYXV0bz1mb3JtYXQmZml0PWNyb3Amdz0xNjA4JnE9ODAnXG4gIH0sXG4gIHtcbiAgICB0aXRsZTogJ0luaWFuIElzbGFuZHMnLFxuICAgIGxpbms6ICdodHRwczovL2ltYWdlcy51bnNwbGFzaC5jb20vcGhvdG8tMTU5NzgwMDIzNTQyNS1lZjIzYjhiY2RmZmQ/aXhpZD1Nbnd4TWpBM2ZEQjhNSHh3YUc5MGJ5MXdZV2RsZkh4OGZHVnVmREI4Zkh4OCZpeGxpYj1yYi0xLjIuMSZhdXRvPWZvcm1hdCZmaXQ9Y3JvcCZ3PTk2OCZxPTgwJ1xuICB9LFxuICB7XG4gICAgdGl0bGU6ICdBbnRlbG9wZSBDYW55b24nLFxuICAgIGxpbms6ICdodHRwczovL2ltYWdlcy51bnNwbGFzaC5jb20vcGhvdG8tMTUwNTUyMTM3Nzc3NC0xMDNhOGNjMmY3MzU/aXhsaWI9cmItMS4yLjEmaXhpZD1Nbnd4TWpBM2ZEQjhNSHh3YUc5MGJ5MXdZV2RsZkh4OGZHVnVmREI4Zkh4OCZhdXRvPWZvcm1hdCZmaXQ9Y3JvcCZ3PTkzNCZxPTgwJ1xuICB9LFxuICB7XG4gICAgdGl0bGU6ICdHcmFuZCBUZXRvbiBOYXRpb25hbCBQYXJrJyxcbiAgICBsaW5rOiAnaHR0cHM6Ly9pbWFnZXMudW5zcGxhc2guY29tL3Bob3RvLTE1MzMwODM2NTMzNDktZTI4ODJjMGQxMjA4P2l4bGliPXJiLTEuMi4xJml4aWQ9TW53eE1qQTNmREI4TUh4d2FHOTBieTF3WVdkbGZIeDhmR1Z1ZkRCOGZIeDgmYXV0bz1mb3JtYXQmZml0PWNyb3Amdz0xNTAwJnE9ODAnXG4gIH0sXG4gIHtcbiAgICB0aXRsZTogJ0JvdWxkZXIsIENvbG9yYWRvJyxcbiAgICBsaW5rOiAnaHR0cHM6Ly9pbWFnZXMudW5zcGxhc2guY29tL3Bob3RvLTE2MDk2NDU5MTg2NTUtNjVjNTIzOTVmOTc2P2l4bGliPXJiLTEuMi4xJml4aWQ9TW53eE1qQTNmREI4TUh4d2FHOTBieTF3WVdkbGZIeDhmR1Z1ZkRCOGZIeDgmYXV0bz1mb3JtYXQmZml0PWNyb3Amdz0xMDAwJnE9ODAnXG4gIH1cbl07IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xuICBjb25zdHJ1Y3Rvcih7dXNlck5hbWUsIHVzZXJKb2J9KSB7XG4gICAgdGhpcy5fcHJvZmlsZU5hbWVFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih1c2VyTmFtZSk7XG4gICAgdGhpcy5fcHJvZmlsZVRpdGxlRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodXNlckpvYik7XG4gIH1cbiAgXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHRoaXMuX3VzZXJJbmZvID0ge1xuICAgICAgbmFtZTogdGhpcy5fcHJvZmlsZU5hbWVFbGVtZW50LnRleHRDb250ZW50LFxuICAgICAgZGVzY3JpcHRpb246IHRoaXMuX3Byb2ZpbGVUaXRsZUVsZW1lbnQudGV4dENvbnRlbnRcbiAgICB9O1xuXG4gICAgcmV0dXJuIHRoaXMuX3VzZXJJbmZvO1xuICB9XG4gIFxuICBzZXRVc2VySW5mbyA9ICh7Zm9ybURhdGF9KSA9PiB7XG4gICAgdGhpcy5fcHJvZmlsZU5hbWVFbGVtZW50LnRleHRDb250ZW50ID0gZm9ybURhdGEubmFtZTtcbiAgICB0aGlzLl9wcm9maWxlVGl0bGVFbGVtZW50LnRleHRDb250ZW50ID0gZm9ybURhdGEuZGVzY3JpcHRpb247XG4gIH1cbn0iXSwibmFtZXMiOlsidmFsaWRhdGlvbkNvbmZpZyIsImZvcm1TZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiY2FyZFRlbXBsYXRlIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY29udGVudCIsImFkZENhcmRNb2RhbCIsInByb2ZpbGVFZGl0QnRuIiwiYWRkQ2FyZEJ0biIsInByb2ZpbGVFZGl0TW9kYWwiLCJwcm9maWxlTmFtZUlucHV0IiwicHJvZmlsZURlc2NyaXB0aW9uSW5wdXQiLCJDYXJkIiwiY29uc3RydWN0b3IiLCJkYXRhIiwidGVtcGxhdGUiLCJoYW5kbGVDYXJkQ2xpY2siLCJldnQiLCJjdXJyZW50VGFyZ2V0IiwiY2xhc3NMaXN0IiwidG9nZ2xlIiwidGhpcyIsIl9lbGVtZW50IiwicmVtb3ZlIiwiX3RlbXBsYXRlIiwiX2RhdGEiLCJfaGFuZGxlQ2FyZENsaWNrIiwiX2dldFRlbXBsYXRlIiwiY2xvbmVOb2RlIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiX2NhcmRMaWtlQnV0dG9uIiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9oYW5kbGVMaWtlQnV0dG9uIiwiX2NhcmREZWxldGVCdXR0b24iLCJfaGFuZGxlRGVsZXRlQ2FyZCIsIl9jYXJkSW1hZ2UiLCJnZW5lcmF0ZUNhcmQiLCJjYXJkVGl0bGUiLCJzcmMiLCJsaW5rIiwiYWx0IiwidGl0bGUiLCJ0ZXh0Q29udGVudCIsIkZvcm1WYWxpZGF0b3IiLCJzZXR0aW5ncyIsImZvcm1FbGVtZW50IiwiX3NldHRpbmdzIiwiX2Zvcm1FbGVtZW50IiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbGVtZW50IiwiZXJyb3JFbGVtZW50IiwiaWQiLCJhZGQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9oaWRlSW5wdXRFcnJvciIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2hhc0ludmFsaWRJbnB1dCIsImlucHV0TGlzdCIsInNvbWUiLCJfZGlzYWJsZVN1Ym1pdEJ1dHRvbiIsIl9idXR0b25FbGVtZW50Iiwic2V0QXR0cmlidXRlIiwiZW5hYmxlU3VibWl0QnV0dG9uIiwicmVtb3ZlQXR0cmlidXRlIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiX2lucHV0TGlzdCIsInJlc2V0VmFsaWRhdGlvbiIsImZvckVhY2giLCJpbnB1dCIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJlbmFibGVWYWxpZGF0aW9uIiwicHJldmVudERlZmF1bHQiLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJrZXkiLCJjbG9zZSIsInRhcmdldCIsImNsb3Nlc3QiLCJfcG9wdXAiLCJiaW5kIiwib3BlbiIsIl9yZW1vdmVFdmVudExpc3RlbmVycyIsIl9jbG9zZUJ1dHRvbiIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJfY2hlY2tPdmVybGF5Q29udGFpbmVyIiwiX2hhbmRsZUVzY0Nsb3NlIiwiY29udGFpbnMiLCJQb3B1cFdpdGhGb3JtcyIsImhhbmRsZVN1Ym1pdCIsInN1cGVyIiwiX2Zvcm1WYWx1ZXMiLCJuYW1lIiwidmFsdWUiLCJfaGFuZGxlU3VibWl0IiwiX2dldElucHV0VmFsdWVzIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJyZXNldCIsImVkaXRQcm9maWxlRm9ybVZhbGlkYXRvciIsImFkZENhcmRGb3JtVmFsaWRhdG9yIiwicHJldmlld0NhcmRQb3B1cCIsImNhcHRpb24iLCJpbWFnZUVsZW1lbnQiLCJjYXB0aW9uRWxlbWVudCIsInJlbmRlckNhcmQiLCJpdGVtIiwiY2FyZCIsImNhcmRMaXN0IiwiYWRkSXRlbSIsImNvbnRhaW5lclNlbGVjdG9yIiwiaXRlbXMiLCJyZW5kZXJlciIsIl9pdGVtcyIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJlbGVtZW50IiwicHJlcGVuZCIsInN1Ym1pdENhcmRGb3JtIiwidXNlckRhdGEiLCJ1c2VyTmFtZSIsInVzZXJKb2IiLCJmb3JtRGF0YSIsIl9wcm9maWxlTmFtZUVsZW1lbnQiLCJfcHJvZmlsZVRpdGxlRWxlbWVudCIsImRlc2NyaXB0aW9uIiwiZ2V0VXNlckluZm8iLCJfdXNlckluZm8iLCJzdWJtaXRQcm9maWxlRm9ybSIsInNldFVzZXJJbmZvIl0sInNvdXJjZVJvb3QiOiIifQ==